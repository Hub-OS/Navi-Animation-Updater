function t(t){return t&&t.__esModule?t.default:t}var e,r,o,i,n,a,s=globalThis,f={},h={},l=s.parcelRequire8b80;null==l&&((l=function(t){if(t in f)return f[t].exports;if(t in h){var e=h[t];delete h[t];var r={id:t,exports:{}};return f[t]=r,e.call(r.exports,r,r.exports),r.exports}var o=Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(t,e){h[t]=e},s.parcelRequire8b80=l);var u=l.register;u("12eZZ",function(t,e){var r,o;r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&o.rotl(t,8)|4278255360&o.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=o.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,o=0;r<t.length;r++,o+=8)e[o>>>5]|=t[r]<<24-o%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(t){for(var e=[],o=0;o<t.length;o+=3)for(var i=t[o]<<16|t[o+1]<<8|t[o+2],n=0;n<4;n++)8*o+6*n<=8*t.length?e.push(r.charAt(i>>>6*(3-n)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/ig,"");for(var e=[],o=0,i=0;o<t.length;i=++o%4)0!=i&&e.push((r.indexOf(t.charAt(o-1))&Math.pow(2,-2*i+8)-1)<<2*i|r.indexOf(t.charAt(o))>>>6-2*i);return e}},t.exports=o}),u("a74v9",function(t,e){var r={utf8:{stringToBytes:function(t){return r.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(r.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}};t.exports=r}),u("7B5Ea",function(t,e){function r(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */t.exports=function(t){return null!=t&&(r(t)||"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&r(t.slice(0,0))||!!t._isBuffer)}}),a=function(t){var e=t[0],r="'"===e;return t.substring(1,t.length-1).replace(/\\\\/g,"\\").replace(r?/\\'/g:/\\"/g,e)};const g=/\S/g,d=/[\s=]/g;function c(t,e,r){return e.lastIndex=r,e.exec(t)}function m(t,e){let r;let o={},i=t.indexOf(" ");if(i<0)return o;for(;r=c(t,g,i);){if(!(r=c(t,d,i=r.index)))throw Error(`Unexpected "${t.slice(i)}" on line ${e}`);let n=t.slice(i,r.index),s=t.indexOf("=",r.index);if(s<0)throw Error(`Attribute is missing "=" on line ${e}`);if(!(r=c(t,g,s+1)))throw Error(`Attribute is missing value on line ${e}`);let f=r.index,h="";if('"'==t[f]){let r=function(t,e){for(;;){if((e=t.indexOf('"',e))<0)return -1;if(!function(t,e){let r=!1;for(;e>0&&"\\"==t[e-=1];)r=!r;return r}(t,e))break;e+=1}return e}(t,f+1);if(r<0)throw Error(`String missing closing quote on line ${e}`);r+=1,h=a(t.slice(f,r)),i=r}else{let e=t.indexOf(" ",f);e<0&&(e=t.length),h=t.slice(f,e),i=e}o[n]=h}return o}function p(t,e,r={quoteAllValues:!0}){let o=[t];for(let t in e){let i=e[t];switch(typeof i){case"string":""!=i&&(o.push(" "),o.push(t),o.push("="),o.push('"'+i.replace(/\\|"/g,function(t){return"\\"+t})+'"'));break;case"number":0!=i&&(r.quoteAllValues?o.push(` ${t}="${i}"`):o.push(` ${t}=${i}`));break;case"boolean":!0==i&&(o.push(" "),o.push(t),r.quoteAllValues?o.push('="1"'):o.push("=1"));break;case"object":if(Array.isArray(i))break;default:throw Error(`Unexpected ${typeof i} for ${t}`)}}return o.join("")}var y={},x={},w=function(){};w.prototype={fit:function(t){var e,r,o,i,n=t.length,a=n>0?t[0].width:0,s=n>0?t[0].height:0;for(e=0,this.root={x:0,y:0,width:a,height:s};e<n;e++)o=t[e],i=(r=this.findNode(this.root,o.width,o.height))?this.splitNode(r,o.width,o.height):this.growNode(o.width,o.height),o.x=i.x,o.y=i.y},findNode:function(t,e,r){return t.used?this.findNode(t.right,e,r)||this.findNode(t.down,e,r):e<=t.width&&r<=t.height?t:null},splitNode:function(t,e,r){return t.used=!0,t.down={x:t.x,y:t.y+r,width:t.width,height:t.height-r},t.right={x:t.x+e,y:t.y,width:t.width-e,height:r},t},growNode:function(t,e){var r=t<=this.root.width,o=e<=this.root.height,i=o&&this.root.height>=this.root.width+t,n=r&&this.root.width>=this.root.height+e;return i?this.growRight(t,e):n?this.growDown(t,e):o?this.growRight(t,e):r?this.growDown(t,e):null},growRight:function(t,e){var r;return(this.root={used:!0,x:0,y:0,width:this.root.width+t,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:t,height:this.root.height}},r=this.findNode(this.root,t,e))?this.splitNode(r,t,e):null},growDown:function(t,e){var r;return(this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+e,down:{x:0,y:this.root.height,width:this.root.width,height:e},right:this.root},r=this.findNode(this.root,t,e))?this.splitNode(r,t,e):null}},x=w,y=function(t,e){e=e||{};var r=new x,o=e.inPlace||!1,i=t.map(function(t){return o?t:{width:t.width,height:t.height,item:t}});i=i.sort(function(t,e){return e.width*e.height-t.width*t.height}),r.fit(i);var n={width:i.reduce(function(t,e){return Math.max(t,e.x+e.width)},0),height:i.reduce(function(t,e){return Math.max(t,e.y+e.height)},0)};return o||(n.items=i),n};var v={};function b(t,e,r,o){let i=t[e];for(let n of(i||(i=[],t[e]=i),i))if(n.frames[0].w==r.w&&n.frames[0].h==r.h&&n.imageData.data.every((t,e)=>t==o.data[e]))return n}function F(t){return t.map(t=>({overlayed:[{frame:t,offsetx:0,offsety:0}],outFrame:{x:0,y:0,w:t.w,h:t.h,originx:t.originx,originy:t.originy,flipx:!1,flipy:!1,duration:t.duration,points:t.points},width:0,height:0}))}e=l("12eZZ"),r=l("a74v9").utf8,o=l("7B5Ea"),i=l("a74v9").bin,(n=function(t,a){t.constructor==String?t=a&&"binary"===a.encoding?i.stringToBytes(t):r.stringToBytes(t):o(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||t.constructor===Uint8Array||(t=t.toString());for(var s=e.bytesToWords(t),f=8*t.length,h=1732584193,l=-271733879,u=-1732584194,g=271733878,d=0;d<s.length;d++)s[d]=(s[d]<<8|s[d]>>>24)&16711935|(s[d]<<24|s[d]>>>8)&4278255360;s[f>>>5]|=128<<f%32,s[(f+64>>>9<<4)+14]=f;for(var c=n._ff,m=n._gg,p=n._hh,y=n._ii,d=0;d<s.length;d+=16){var x=h,w=l,v=u,b=g;h=c(h,l,u,g,s[d+0],7,-680876936),g=c(g,h,l,u,s[d+1],12,-389564586),u=c(u,g,h,l,s[d+2],17,606105819),l=c(l,u,g,h,s[d+3],22,-1044525330),h=c(h,l,u,g,s[d+4],7,-176418897),g=c(g,h,l,u,s[d+5],12,1200080426),u=c(u,g,h,l,s[d+6],17,-1473231341),l=c(l,u,g,h,s[d+7],22,-45705983),h=c(h,l,u,g,s[d+8],7,1770035416),g=c(g,h,l,u,s[d+9],12,-1958414417),u=c(u,g,h,l,s[d+10],17,-42063),l=c(l,u,g,h,s[d+11],22,-1990404162),h=c(h,l,u,g,s[d+12],7,1804603682),g=c(g,h,l,u,s[d+13],12,-40341101),u=c(u,g,h,l,s[d+14],17,-1502002290),l=c(l,u,g,h,s[d+15],22,1236535329),h=m(h,l,u,g,s[d+1],5,-165796510),g=m(g,h,l,u,s[d+6],9,-1069501632),u=m(u,g,h,l,s[d+11],14,643717713),l=m(l,u,g,h,s[d+0],20,-373897302),h=m(h,l,u,g,s[d+5],5,-701558691),g=m(g,h,l,u,s[d+10],9,38016083),u=m(u,g,h,l,s[d+15],14,-660478335),l=m(l,u,g,h,s[d+4],20,-405537848),h=m(h,l,u,g,s[d+9],5,568446438),g=m(g,h,l,u,s[d+14],9,-1019803690),u=m(u,g,h,l,s[d+3],14,-187363961),l=m(l,u,g,h,s[d+8],20,1163531501),h=m(h,l,u,g,s[d+13],5,-1444681467),g=m(g,h,l,u,s[d+2],9,-51403784),u=m(u,g,h,l,s[d+7],14,1735328473),l=m(l,u,g,h,s[d+12],20,-1926607734),h=p(h,l,u,g,s[d+5],4,-378558),g=p(g,h,l,u,s[d+8],11,-2022574463),u=p(u,g,h,l,s[d+11],16,1839030562),l=p(l,u,g,h,s[d+14],23,-35309556),h=p(h,l,u,g,s[d+1],4,-1530992060),g=p(g,h,l,u,s[d+4],11,1272893353),u=p(u,g,h,l,s[d+7],16,-155497632),l=p(l,u,g,h,s[d+10],23,-1094730640),h=p(h,l,u,g,s[d+13],4,681279174),g=p(g,h,l,u,s[d+0],11,-358537222),u=p(u,g,h,l,s[d+3],16,-722521979),l=p(l,u,g,h,s[d+6],23,76029189),h=p(h,l,u,g,s[d+9],4,-640364487),g=p(g,h,l,u,s[d+12],11,-421815835),u=p(u,g,h,l,s[d+15],16,530742520),l=p(l,u,g,h,s[d+2],23,-995338651),h=y(h,l,u,g,s[d+0],6,-198630844),g=y(g,h,l,u,s[d+7],10,1126891415),u=y(u,g,h,l,s[d+14],15,-1416354905),l=y(l,u,g,h,s[d+5],21,-57434055),h=y(h,l,u,g,s[d+12],6,1700485571),g=y(g,h,l,u,s[d+3],10,-1894986606),u=y(u,g,h,l,s[d+10],15,-1051523),l=y(l,u,g,h,s[d+1],21,-2054922799),h=y(h,l,u,g,s[d+8],6,1873313359),g=y(g,h,l,u,s[d+15],10,-30611744),u=y(u,g,h,l,s[d+6],15,-1560198380),l=y(l,u,g,h,s[d+13],21,1309151649),h=y(h,l,u,g,s[d+4],6,-145523070),g=y(g,h,l,u,s[d+11],10,-1120210379),u=y(u,g,h,l,s[d+2],15,718787259),l=y(l,u,g,h,s[d+9],21,-343485551),h=h+x>>>0,l=l+w>>>0,u=u+v>>>0,g=g+b>>>0}return e.endian([h,l,u,g])})._ff=function(t,e,r,o,i,n,a){var s=t+(e&r|~e&o)+(i>>>0)+a;return(s<<n|s>>>32-n)+e},n._gg=function(t,e,r,o,i,n,a){var s=t+(e&o|r&~o)+(i>>>0)+a;return(s<<n|s>>>32-n)+e},n._hh=function(t,e,r,o,i,n,a){var s=t+(e^r^o)+(i>>>0)+a;return(s<<n|s>>>32-n)+e},n._ii=function(t,e,r,o,i,n,a){var s=t+(r^(e|~o))+(i>>>0)+a;return(s<<n|s>>>32-n)+e},n._blocksize=16,n._digestsize=16,v=function(t,r){if(null==t)throw Error("Illegal argument "+t);var o=e.wordsToBytes(n(t,r));return r&&r.asBytes?o:r&&r.asString?i.bytesToString(o):e.bytesToHex(o)};const E={HAND:function(){},HILT:function(){},CHARACTER_SWING:function(t,e,r){let o=t.animations.find(t=>"HILT"==t.state.toUpperCase());if(o){let t=F(r.frames),i=1;for(let e of(t[0].outFrame.points=[],o.frames)){let r=t[i++],o=r.overlayed[0].frame,n=o.points.find(t=>"HILT"==t.label.toUpperCase())??{x:0,y:0},a=n.x-o.originx,s=n.y-o.originy;r.overlayed.push({frame:e,offsetx:a,offsety:s});let f=e.points.find(t=>"ENDPOINT"==t.label.toUpperCase());r.outFrame.points=[{label:"ENDPOINT",x:n.x-e.originx+(f?.x??0),y:n.y-e.originy+(f?.y??0)}]}e.CHARACTER_SWING_HILT=t}let i=t.animations.find(t=>"HAND"==t.state.toUpperCase());if(i){let t=F(r.frames),o=1;for(let r of(t[0].outFrame.points=[],i.frames)){let i=t[o++],n=i.overlayed[0].frame,a=n.points.find(t=>"HILT"==t.label.toUpperCase())??{x:0,y:0};i.overlayed.push({frame:r,offsetx:a.x-n.originx,offsety:a.y-n.originy}),i.outFrame.points=[],e.CHARACTER_SWING_HAND=t}}}},T={};function A(t){console.error(t),alert(t)}async function N(e){for(let t of e)if(t.name.endsWith(".png"))try{T.image=await function(t){return new Promise((e,r)=>{let o=new FileReader;o.onload=function(){let i=new Image;i.src=o.result,i.onload=function(){e(i)},i.onerror=function(){r(Error(`Failed to load "${t.name}"`))}},o.onerror=function(){r(Error(`Failed to load "${t.name}: ${o.error}"`))},o.readAsDataURL(t)})}(t),T.imageError=void 0}catch(t){console.error(t),T.imageError=t.toString()}else if(t.name.endsWith(".animation"))try{let e=await function(t){return new Promise((e,r)=>{let o=new FileReader;o.onload=function(){e(o.result)},o.onerror=function(){r(Error(`Failed to load "${t.name}: ${o.error}"`))},o.readAsText(t)})}(t);T.animations=function(t){let e,r;let o=[],i=0;for(let n of t.split("\n"))if(n=n.trim(),i+=1,!(""==n||n.startsWith("#")||n.startsWith("imagePath")||n.startsWith("version"))){if(n.startsWith("animation ")){let t=m(n,i),r={state:t.state,frames:[]};if(!t.state)throw Error(`Animation is missing state name on line ${i}`);o.push(r),e=r}else if(n.startsWith("frame")||n.startsWith("blank")){if(!e)throw Error(`No animation state to associate frame with on line ${i}`);let t=m(n,i),o={x:parseFloat(t.x)||0,y:parseFloat(t.y)||0,w:parseFloat(t.w)||0,h:parseFloat(t.h)||0,originx:parseFloat(t.originx)||0,originy:parseFloat(t.originy)||0,flipx:1==parseInt(t.flipx),flipy:1==parseInt(t.flipy),duration:t.duration||"",points:[]};e.frames.push(o),r=o}else if(n.startsWith("point ")){if(!r)throw Error(`No frame to associate point with on line ${i}`);let t=m(n,i);if(!t.label)throw Error(`Point is missing label on line ${i}`);let e={label:t.label,x:parseFloat(t.x),y:parseFloat(t.y)};r.points.push(e)}else{let t=n.indexOf(" "),e=t<0?n:n.slice(0,t);throw Error(`Unexpected "${e}" on line ${i}`)}}return o}(e),T.animationError=void 0}catch(t){console.error(t),T.animationError=t.toString()}T.imageError||T.animationError||function(){let e=document.querySelector("canvas"),r=document.querySelector("textarea");try{let o=document.createElement("canvas"),i=function(e,r){if(!r.animations||!r.image)return[];let o={};for(let t of r.animations){let e=E[t.state.toUpperCase()];e?e(r,o,t):o[t.state]=F(t.frames)}let i=Object.values(o).flat();for(let t of i){let e=t.outFrame.originx,r=t.outFrame.originy;for(let{frame:e,offsetx:r,offsety:o}of t.overlayed)t.outFrame.originx=Math.max(t.outFrame.originx,e.originx-r),t.outFrame.originy=Math.max(t.outFrame.originy,e.originy-o);let o=t.outFrame.originx-e,i=t.outFrame.originy-r;for(let e of t.outFrame.points)e.x-=o,e.y-=i;for(let{frame:e,offsetx:r,offsety:o}of t.overlayed)t.outFrame.w=Math.max(t.outFrame.w,t.outFrame.originx-e.originx+e.w+r),t.outFrame.h=Math.max(t.outFrame.h,t.outFrame.originy-e.originy+e.h+o);t.width=t.outFrame.w+2,t.height=t.outFrame.h+2}let n=t(y)(i);e.width=n.width,e.height=n.height;let a=e.getContext("2d");for(let t of n.items){let e=t.x+1,o=t.y+1,{outFrame:i}=t.item;i.x=e,i.y=o;let n=r.image;for(let{frame:e,offsetx:r,offsety:o}of t.item.overlayed){if(!n)continue;let t=i.x+i.originx-e.originx+r,s=i.y+i.originy-e.originy+o;a.save(),a.translate(t,s),e.flipx&&(a.translate(e.w,0),a.scale(-1,1)),e.flipy&&(a.translate(e.h,0),a.scale(1,-1)),a.drawImage(n,e.x,e.y,e.w,e.h,0,0,e.w,e.h),a.restore()}}return Object.entries(o).map(([t,e])=>({state:t,frames:e.map(t=>t.outFrame)}))}(o,T);!function(e,r,o){let i=r.getContext("2d"),n={};for(let e of o)for(let r of e.frames){let e=i.getImageData(r.x,r.y,r.w,r.h),o=t(v)(e.data),h=b(n,o,r,e);if(!h){let o=i.getImageData(r.x,r.y,r.w,r.h);for(let t=0;t<r.h;t++)for(let i=0;i<r.w;i++){var a,s,f;let n=(a=r.w,(t*a+i)*4),h=(s=r.w,f=r.w-i-1,(t*s+f)*4);for(let t=0;t<4;t++)o.data[n+t]=e.data[h+t]}(h=b(n,t(v)(o.data),r,o))&&(r.flipx=!r.flipx,r.originx=r.w-r.originx)}h?h.frames.push(r):n[o].push({frames:[r],imageData:e,width:r.w+2,height:r.h+2})}let h=Object.values(n).flat(),l=t(y)(h);e.width=l.width,e.height=l.height;let u=e.getContext("2d");for(let t of l.items){let{frames:e}=t.item,o=t.item.frames[0],i=t.x+1,n=t.y+1;for(let t of(u.drawImage(r,o.x,o.y,o.w,o.h,i,n,o.w,o.h),e))t.x=i,t.y=n}}(e,o,i),r.value=function(t){let e=[];for(let r of t){for(let t of(e.push(p("animation",r)),r.frames))for(let r of(e.push(p("frame",t)),t.points))e.push(p("point",r));e.push("")}return e.join("\n")}(i)}catch(t){A(t)}}()}document.body.addEventListener("dragover",t=>t.preventDefault()),document.body.addEventListener("drop",t=>{let e=t.dataTransfer?.items;if(!e)return;t.preventDefault();let r=[];for(let t of e){let e=t.getAsFile();e&&r.push(e)}N(r).catch(A).finally(()=>{document.querySelector("#error-text").innerText=function(){if(!T.image||!T.animations){if(T.animationError)return T.animationError;if(T.imageError)return T.imageError;if(!T.animations)return"Missing .animation file";if(!T.image)return"Missing image file"}return""}()})});
//# sourceMappingURL=index.9b671f25.js.map
